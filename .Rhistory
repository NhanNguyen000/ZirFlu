pivot_wider(names_from = "time", values_from = protein) %>%
rename("log2_proExp" = {{protein}})
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
rename("log2_proExp" = 5)
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
rename("log2_proExp" = protein)
View(plot_dat)
check_protein <- ZirFlu$protein_annot %>%
filter(OlinkID %in%  rownames(resPrePost_protein$`2019`$T1vsT3$pval))
plotList <- list()
for (protein in check_protein$OlinkID) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
rename("log2_proExp" = protein)
plotList[[protein]] <- ggboxplot(plot_dat, x = "time", y = "log2_proExp",
palette = "npg", add = "jitter", color = "disease")
xlab(paste0("log2_proExp_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList$OID20442
check_protein$Assay[which(check_protein$OlinkID == protein) ]
plotList <- list()
for (protein in check_protein$OlinkID) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
rename("log2_proExp" = protein)
plotList[[protein]] <- ggboxplot(plot_dat, x = "time", y = "log2_proExp",
palette = "npg", add = "jitter", color = "disease")
xlab(paste0("log2_proExp_", check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList <- list()
for (protein in check_protein$OlinkID) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
rename("log2_proExp" = protein)
plotList[[protein]] <- ggboxplot(plot_dat, x = "time", y = "log2_proExp",
palette = "npg", add = "jitter", color = "disease")
xlab(paste0("log2_proExp_", check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList$OID20442
for (protein in check_protein$OlinkID) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
rename("log2_proExp" = protein)
plotList[[protein]] <- ggboxplot(plot_dat, x = "time", y = "log2_proExp",
palette = "npg", add = "jitter", color = "disease") +
xlab(paste0("log2_proExp_", check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList$OID20442
for (protein in check_protein$OlinkID) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
rename("log2_proExp" = protein)
plotList[[protein]] <- ggboxplot(plot_dat, x = "time", y = "log2_proExp",
palette = "npg", add = "jitter", color = "disease") +
ylab(paste0("log2_proExp_", check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList$OID20442
pdf(file = "selectPro_sigPval_T3vsT1_boxplot.pdf", width = 12, onefile = TRUE)
ml1 <- marrangeGrob(plotList, nrow = 2, ncol = 3)
ml1
dev.off()
# correlation betweel change in abTiter vs. change in protein
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter) %>%
left_join(ZirFlu$donorSamples %>% filter(time == "T1")) %>%
left_join(ZirFlu$protein_dat %>% rownames_to_column("probenID")) %>%
filter(season == "2019")
View(inputDat)
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter)
View(inputDat)
# correlation betweel change in abTiter vs. change in protein
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter) %>%
mutate(H1N1_T3vsT1 = H1N1_T3 - H1N1_T1) %>%
mutate(H3N2_T3vsT1 = H3N2_T3 - H3N2_T1) %>%
mutate(Bvictoria_T3vsT1 = Bvictoria_T3 - Bvictoria_T1) %>%
mutate(Byamagata_T3vsT1 = Byamagata_T3 - Byamagata_T1)
View(inputDat)
View(inputDat)
# correlation betweel change in abTiter vs. change in protein
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter) %>%
mutate(H1N1_T3vsT1 = H1N1_T3 - H1N1_T1) %>%
mutate(H3N2_T3vsT1 = H3N2_T3 - H3N2_T1) %>%
mutate(Bvictoria_T3vsT1 = Bvictoria_T3 - Bvictoria_T1) %>%
mutate(Byamagata_T3vsT1 = Byamagata_T3 - Byamagata_T1) %>%
select(-matches("_T1", "_T2"))
View(inputDat)
# correlation betweel change in abTiter vs. change in protein
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter) %>%
mutate(H1N1_T3vsT1 = H1N1_T3 - H1N1_T1) %>%
mutate(H3N2_T3vsT1 = H3N2_T3 - H3N2_T1) %>%
mutate(Bvictoria_T3vsT1 = Bvictoria_T3 - Bvictoria_T1) %>%
mutate(Byamagata_T3vsT1 = Byamagata_T3 - Byamagata_T1)
# correlation betweel change in abTiter vs. change in protein
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter) %>%
mutate(H1N1_T3vsT1 = H1N1_T3 - H1N1_T1) %>%
mutate(H3N2_T3vsT1 = H3N2_T3 - H3N2_T1) %>%
mutate(Bvictoria_T3vsT1 = Bvictoria_T3 - Bvictoria_T1) %>%
mutate(Byamagata_T3vsT1 = Byamagata_T3 - Byamagata_T1) %>%
filter(season == "2019")
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter) %>%
left_join(ZirFlu$donorSamples %>% filter(time != "T2")) %>%
left_join(ZirFlu$protein_dat %>% rownames_to_column("probenID")) %>%
filter(season == "2019")
View(inputDat)
# correlation betweel change in abTiter vs. change in protein
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter) %>%
left_join(ZirFlu$donorSamples %>% filter(time != "T2")) %>%
mutate(H1N1_T3vsT1 = H1N1_T3 - H1N1_T1) %>%
mutate(H3N2_T3vsT1 = H3N2_T3 - H3N2_T1) %>%
mutate(Bvictoria_T3vsT1 = Bvictoria_T3 - Bvictoria_T1) %>%
mutate(Byamagata_T3vsT1 = Byamagata_T3 - Byamagata_T1) %>%
filter(season == "2019")
View(inputDat)
28+33+28+31
# correlation betweel change in abTiter vs. change in protein
inputDat <- ZirFlu$donorInfo %>% full_join(ZirFlu$HAItiter) %>%
left_join(ZirFlu$donorSamples %>% filter(time != "T2")) %>%
left_join(ZirFlu$protein_dat %>% rownames_to_column("probenID")) %>%
filter(season == "2019")
View(inputDat)
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein))
View(plot_dat)
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein)
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
View(inputDat)
ab_T3vsT1 <- inputDat %>%
select(patientID, condition, disease, matches("T1|T3"))
View(ab_T3vsT1)
ab_T3vsT1 <- inputDat %>%
select(patientID, condition, disease, matches("T1|T3")) %>%
mutate(H1N1_T3vsT1 = H1N1_T3 - H1N1_T1) %>%
mutate(H3N2_T3vsT1 = H3N2_T3 - H3N2_T1) %>%
mutate(Bvictoria_T3vsT1 = Bvictoria_T3 - Bvictoria_T1) %>%
mutate(Byamagata_T3vsT1 = Byamagata_T3 - Byamagata_T1)
View(ab_T3vsT1)
ab_T3vsT1 <- inputDat %>%
select(patientID, condition, disease, matches("T1|T3")) %>%
mutate(H1N1_T3vsT1 = H1N1_T3 - H1N1_T1) %>%
mutate(H3N2_T3vsT1 = H3N2_T3 - H3N2_T1) %>%
mutate(Bvictoria_T3vsT1 = Bvictoria_T3 - Bvictoria_T1) %>%
mutate(Byamagata_T3vsT1 = Byamagata_T3 - Byamagata_T1) %>% distinct()
View(ab_T3vsT1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
View(plot_dat2)
plot_dat2 %>%
ggscatter(x = "H1N1_T3vsT1", y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab(paste0("log2Exp_T1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ])) +
ylab(paste0("log2Exp_T3_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plot_dat2 %>%
ggscatter(x = "H1N1_T3vsT1", y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
names(ab_T3vsT1)
iMED_plotList_total3 <- list()
iMED_plotList_total4 <- list()
for (selectedVal in check_protein$OlinkID) {
plotList3 <- list()
plotList4 <- list()
for(abTiter in c("H1N1_T3vsT1", "H3N2_T3vsT1", "Bvictoria_T3vsT1", "Byamagata_T3vsT1")) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
plotList3[[abType]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plotList4[[abType]] <- plot_dat %>%
ggscatter(x = abTiter, y = "protein_T3vsT1", add = "reg.line") +
stat_cor(method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
iMED_plotList_total3[[selectedVal]] <- plotList3
iMED_plotList_total4[[selectedVal]] <- plotList4
}
iMED_plotList_total3 <- list()
iMED_plotList_total4 <- list()
for (selectedVal in check_protein$OlinkID) {
plotList3 <- list()
plotList4 <- list()
for(abTiter in c("H1N1_T3vsT1", "H3N2_T3vsT1", "Bvictoria_T3vsT1", "Byamagata_T3vsT1")) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
plotList3[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plotList4[[abTiter]] <- plot_dat %>%
ggscatter(x = abTiter, y = "protein_T3vsT1", add = "reg.line") +
stat_cor(method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
iMED_plotList_total3[[selectedVal]] <- plotList3
iMED_plotList_total4[[selectedVal]] <- plotList4
}
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
iMED_plotList_total3 <- list()
iMED_plotList_total4 <- list()
for (selectedVal in check_protein$OlinkID) {
plotList3 <- list()
plotList4 <- list()
for(abTiter in c("H1N1_T3vsT1", "H3N2_T3vsT1", "Bvictoria_T3vsT1", "Byamagata_T3vsT1")) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
plotList3[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plotList4[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1", add = "reg.line") +
stat_cor(method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
iMED_plotList_total3[[selectedVal]] <- plotList3
iMED_plotList_total4[[selectedVal]] <- plotList4
}
plotList_total3[[protein]]
plotList_total3 <- list()
plotList_total4 <- list()
for (selectedVal in check_protein$OlinkID) {
plotList3 <- list()
plotList4 <- list()
for(abTiter in c("H1N1_T3vsT1", "H3N2_T3vsT1", "Bvictoria_T3vsT1", "Byamagata_T3vsT1")) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
plotList3[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plotList4[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1", add = "reg.line") +
stat_cor(method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList_total3[[selectedVal]] <- plotList3
plotList_total4[[selectedVal]] <- plotList4
}
plotList_total3[[protein]]$H1N1_T3vsT1
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1)
pdf(file = "proPval_T3vsT1_2019.pdf", width = 12, onefile = TRUE)
for (protein in as.character(check_metabolites$ionIdx)) {
plot(cowplot::plot_grid(
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1),
cowplot::plot_grid(plotList_total4[[protein]]$H1N1_T3vsT1,
plotList_total4[[protein]]$H3N2_T3vsT1,
plotList_total4[[protein]]$Bvictoria_T3vsT1,
plotList_total4[[protein]]$Byamagata_T3vsT1,
nrow = 1),
nrow = 2
))
}
pdf(file = "proPval_T3vsT1_2019.pdf", width = 12, onefile = TRUE)
for (protein in as.character(check_protein$ionIdx)) {
plot(cowplot::plot_grid(
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1),
cowplot::plot_grid(plotList_total4[[protein]]$H1N1_T3vsT1,
plotList_total4[[protein]]$H3N2_T3vsT1,
plotList_total4[[protein]]$Bvictoria_T3vsT1,
plotList_total4[[protein]]$Byamagata_T3vsT1,
nrow = 1),
nrow = 2
))
}
dev.off()
pdf(file = "proPval_T3vsT1_2019.pdf", width = 12, onefile = TRUE)
for (protein in as.character(check_protein$OlinkID)) {
plot(cowplot::plot_grid(
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1),
cowplot::plot_grid(plotList_total4[[protein]]$H1N1_T3vsT1,
plotList_total4[[protein]]$H3N2_T3vsT1,
plotList_total4[[protein]]$Bvictoria_T3vsT1,
plotList_total4[[protein]]$Byamagata_T3vsT1,
nrow = 1),
nrow = 2
))
}
dev.off()
check_protein$OlinkID
pdf(file = "proPval_T3vsT1_2019.pdf", width = 12, onefile = TRUE)
for (protein in check_protein$OlinkID) {
plot(cowplot::plot_grid(
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1),
cowplot::plot_grid(plotList_total4[[protein]]$H1N1_T3vsT1,
plotList_total4[[protein]]$H3N2_T3vsT1,
plotList_total4[[protein]]$Bvictoria_T3vsT1,
plotList_total4[[protein]]$Byamagata_T3vsT1,
nrow = 1),
nrow = 2
))
}
dev.off()
plotList_total3 <- list()
plotList_total4 <- list()
for (protein in check_protein$OlinkID) {
plotList3 <- list()
plotList4 <- list()
for(abTiter in c("H1N1_T3vsT1", "H3N2_T3vsT1", "Bvictoria_T3vsT1", "Byamagata_T3vsT1")) {
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
plotList3[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plotList4[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1", add = "reg.line") +
stat_cor(method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList_total3[[selectedVal]] <- plotList3
plotList_total4[[selectedVal]] <- plotList4
}
pdf(file = "proPval_T3vsT1_2019.pdf", width = 12, onefile = TRUE)
for (protein in check_protein$OlinkID) {
plot(cowplot::plot_grid(
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1),
cowplot::plot_grid(plotList_total4[[protein]]$H1N1_T3vsT1,
plotList_total4[[protein]]$H3N2_T3vsT1,
plotList_total4[[protein]]$Bvictoria_T3vsT1,
plotList_total4[[protein]]$Byamagata_T3vsT1,
nrow = 1),
nrow = 2
))
}
dev.off()
check_protein$OlinkID
protein
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1)
protein <- "OID20762"
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1)
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
for(abTiter in c("H1N1_T3vsT1", "H3N2_T3vsT1", "Bvictoria_T3vsT1", "Byamagata_T3vsT1")) {
plotList3[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plotList4[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1", add = "reg.line") +
stat_cor(method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList3$H1N1_T3vsT1
plotList_total3 <- list()
plotList_total4 <- list()
for (protein in check_protein$OlinkID) {
plotList3 <- list()
plotList4 <- list()
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
for(abTiter in c("H1N1_T3vsT1", "H3N2_T3vsT1", "Bvictoria_T3vsT1", "Byamagata_T3vsT1")) {
plotList3[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plotList4[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1", add = "reg.line") +
stat_cor(method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList_total3[[selectedVal]] <- plotList3
plotList_total4[[selectedVal]] <- plotList4
}
plotList_total3 <- list()
plotList_total4 <- list()
for (protein in check_protein$OlinkID) {
plotList3 <- list()
plotList4 <- list()
plot_dat <- inputDat %>%
select(patientID, condition, disease, time, all_of(protein)) %>%
pivot_wider(names_from = "time", values_from = protein) %>%
mutate(protein_T3vsT1 = T3 - T1)
plot_dat2 <- ab_T3vsT1 %>% full_join(plot_dat)
for(abTiter in c("H1N1_T3vsT1", "H3N2_T3vsT1", "Bvictoria_T3vsT1", "Byamagata_T3vsT1")) {
plotList3[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1",
color = "disease", add = "reg.line") +
stat_cor(aes(color = disease), method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
plotList4[[abTiter]] <- plot_dat2 %>%
ggscatter(x = abTiter, y = "protein_T3vsT1", add = "reg.line") +
stat_cor(method = "pearson") +
xlab("log2_H1N1_T3vsT1") +
ylab(paste0("log2Exp_proT3vsT1_",
check_protein$Assay[which(check_protein$OlinkID == protein) ]))
}
plotList_total3[[protein]] <- plotList3
plotList_total4[[protein]] <- plotList4
}
pdf(file = "proPval_T3vsT1_2019.pdf", width = 12, onefile = TRUE)
for (protein in check_protein$OlinkID) {
plot(cowplot::plot_grid(
cowplot::plot_grid(plotList_total3[[protein]]$H1N1_T3vsT1,
plotList_total3[[protein]]$H3N2_T3vsT1,
plotList_total3[[protein]]$Bvictoria_T3vsT1,
plotList_total3[[protein]]$Byamagata_T3vsT1,
nrow = 1),
cowplot::plot_grid(plotList_total4[[protein]]$H1N1_T3vsT1,
plotList_total4[[protein]]$H3N2_T3vsT1,
plotList_total4[[protein]]$Bvictoria_T3vsT1,
plotList_total4[[protein]]$Byamagata_T3vsT1,
nrow = 1),
nrow = 2
))
}
dev.off()
